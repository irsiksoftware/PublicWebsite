"use strict";(self.webpackChunktestforai=self.webpackChunktestforai||[]).push([[376],{795:()=>{function e(e){return function(e){if(Array.isArray(e))return r(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||n(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=n(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,l=!0,f=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return l=e.done,e},e:function(e){f=!0,a=e},f:function(){try{l||null==r.return||r.return()}finally{if(f)throw a}}}}function n(e,t){if(e){if("string"==typeof e)return r(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var o,i,a,l,f,c,u=10,h=20,s=32,d=null,v=null,y=null,g=!0,m=[],p={score:0,level:1,lines:0,highScore:0,isPaused:!1,isGameOver:!1},S=null,E=1e3;function x(){var e,t,n,r,s,d,v;o=document.getElementById("tetris-game"),i=o.getContext("2d"),a=document.getElementById("next-piece"),l=a.getContext("2d"),f=document.getElementById("hold-piece"),c=f.getContext("2d"),(e=localStorage.getItem("tetrisHighScore"))&&(p.highScore=parseInt(e,10)),m=Array(h).fill(null).map(function(){return Array(u).fill(0)}),b(),I(),document.addEventListener("keydown",T),t=document.getElementById("btn-left"),n=document.getElementById("btn-right"),r=document.getElementById("btn-down"),s=document.getElementById("btn-rotate"),d=document.getElementById("btn-hold"),v=function(e){e.preventDefault()},t.addEventListener("touchstart",function(e){v(e),L()}),t.addEventListener("click",function(){L()}),n.addEventListener("touchstart",function(e){v(e),B()}),n.addEventListener("click",function(){B()}),r.addEventListener("touchstart",function(e){v(e),C()}),r.addEventListener("click",function(){C()}),s.addEventListener("touchstart",function(e){v(e),P()}),s.addEventListener("click",function(){P()}),d.addEventListener("touchstart",function(e){v(e),N()}),d.addEventListener("click",function(){N()}),R(),k(),W(),D()}function b(){var e=["I","O","T","S","Z","J","L"],t=e[Math.floor(Math.random()*e.length)],n=TETROMINO_SHAPES[t];v={shape:n.rotations[0],color:n.color,type:t}}function I(){d={x:Math.floor(5)-2,y:0,shape:v.shape,color:v.color,type:v.type,rotation:0},b(),D(),G(d.x,d.y)||(p.isGameOver=!0,w())}function k(){S&&clearInterval(S),E=Math.max(100,1e3-50*p.level),S=setInterval(A,E)}function w(){S&&(clearInterval(S),S=null)}function A(){p.isPaused||p.isGameOver||(G(d.x,d.y+1)?d.y++:(M(),O(),I()),W())}function M(){for(var e=d.shape,t=0;t<e.length;t++)for(var n=0;n<e[t].length;n++)if(e[t][n]){var r=d.y+t,o=d.x+n;r>=0&&r<h&&o>=0&&o<u&&(m[r][o]=d.color)}g=!0}function O(){for(var n=[],r=0;r<h;r++)m[r].every(function(e){return 0!==e})&&n.push(r);0!==n.length&&function(n,r){var o,i=[],a=t(n);try{for(a.s();!(o=a.n()).done;){var l=o.value;i.push(e(m[l]))}}catch(e){a.e(e)}finally{a.f()}var f=0,c=3,h=setInterval(function(){var e,o=f%2==0,a=t(n);try{for(a.s();!(e=a.n()).done;)for(var l=e.value,s=0;s<u;s++)m[l][s]=o?"#ffffff":i[n.indexOf(l)][s]}catch(e){a.e(e)}finally{a.f()}W(),++f>=2*c&&(clearInterval(h),r())},100)}(n,function(){for(var e=n.length-1;e>=0;e--)m.splice(n[e],1),m.unshift(Array(u).fill(0));p.lines+=n.length;p.score+=({1:100,2:300,3:500,4:800}[n.length]||100)*p.level,p.score>p.highScore&&(p.highScore=p.score,localStorage.setItem("tetrisHighScore",p.highScore.toString()));var t=Math.floor(p.lines/10)+1;t>p.level&&(p.level=t,k()),R(),W()})}function R(){document.getElementById("score").textContent=p.score,document.getElementById("level").textContent=p.level,document.getElementById("lines").textContent=p.lines,document.getElementById("high-score").textContent=p.highScore}function T(e){switch(e.key){case"ArrowLeft":case"a":case"A":L();break;case"ArrowRight":case"d":case"D":B();break;case"ArrowDown":case"s":case"S":C();break;case"ArrowUp":case"w":case"W":P();break;case"c":case"C":N()}}function L(){G(d.x-1,d.y)&&(d.x--,W())}function B(){G(d.x+1,d.y)&&(d.x++,W())}function C(){G(d.x,d.y+1)?(d.y++,W()):(M(),O(),I(),W())}function P(){if(!p.isPaused&&!p.isGameOver&&d){var e=TETROMINO_SHAPES[d.type],t=(d.rotation+1)%4,n=e.rotations[t];if(!H(d.x,d.y,n))return d.rotation=t,d.shape=n,void W();for(var r=0,o=[1,-1,2,-2];r<o.length;r++){var i=o[r];if(!H(d.x+i,d.y,n))return d.x+=i,d.rotation=t,d.shape=n,void W()}}}function G(e,t){for(var n=d.shape,r=0;r<n.length;r++)for(var o=0;o<n[r].length;o++)if(n[r][o]){var i=e+o,a=t+r;if(i<0)return!1;if(i>=u)return!1;if(a>=h)return!1;if(a>=0&&0!==m[a][i])return!1}return!0}function H(e,t,n){for(var r=n||d.shape,o=0;o<r.length;o++)for(var i=0;i<r[o].length;i++)if(r[o][i]){var a=e+i,l=t+o;if(a<0||a>=u)return!0;if(l<0||l>=h)return!0;if(l>=0&&0!==m[l][a])return!0}return!1}function W(){!function(){i.fillStyle="#ffffff",i.fillRect(0,0,o.width,o.height),i.strokeStyle="#e0e0e0",i.lineWidth=1;for(var e=0;e<=h;e++)i.beginPath(),i.moveTo(0,e*s),i.lineTo(320,e*s),i.stroke();for(var t=0;t<=u;t++)i.beginPath(),i.moveTo(t*s,0),i.lineTo(t*s,640),i.stroke()}();for(var e=0;e<h;e++)for(var t=0;t<u;t++)if(0!==m[e][t]){i.fillStyle=m[e][t];var n=t*s,r=e*s;i.fillRect(n,r,s,s),i.strokeStyle="#333333",i.lineWidth=2,i.strokeRect(n,r,s,s)}if(d){i.fillStyle=d.color;for(var a=d.shape,l=0;l<a.length;l++)for(var f=0;f<a[l].length;f++)if(a[l][f]){var c=(d.x+f)*s,v=(d.y+l)*s;i.fillRect(c,v,s,s),i.strokeStyle="#333333",i.lineWidth=2,i.strokeRect(c,v,s,s)}}p.isGameOver&&(i.fillStyle="rgba(0, 0, 0, 0.7)",i.fillRect(0,o.height/2-40,o.width,80),i.fillStyle="#ffffff",i.font="32px Arial",i.textAlign="center",i.fillText("Game Over",o.width/2,o.height/2))}function D(){if(l.fillStyle="#ffffff",l.fillRect(0,0,a.width,a.height),v){for(var e=v.shape,t=16,n=e.length,r=0,o=e[0].length,i=0,f=0;f<e.length;f++)for(var c=0;c<e[f].length;c++)e[f][c]&&(n=Math.min(n,f),r=Math.max(r,f),o=Math.min(o,c),i=Math.max(i,c));var u=(i-o+1)*t,h=(r-n+1)*t,s=(a.width-u)/2,d=(a.height-h)/2;l.fillStyle=v.color;for(var y=0;y<e.length;y++)for(var g=0;g<e[y].length;g++)if(e[y][g]){var m=s+(g-o)*t,p=d+(y-n)*t;l.fillRect(m,p,t,t),l.strokeStyle="#333333",l.lineWidth=1,l.strokeRect(m,p,t,t)}}}function N(){if(!p.isPaused&&!p.isGameOver&&d&&g){if(g=!1,null===y)y={shape:TETROMINO_SHAPES[d.type].rotations[0],color:d.color,type:d.type},I();else{var e=d.type,t=d.color;d={x:Math.floor(5)-2,y:0,shape:y.shape,color:y.color,type:y.type,rotation:0},y={shape:TETROMINO_SHAPES[e].rotations[0],color:t,type:e},G(d.x,d.y)||(p.isGameOver=!0,w())}!function(){if(c.fillStyle="#ffffff",c.fillRect(0,0,f.width,f.height),y){for(var e=y.shape,t=16,n=e.length,r=0,o=e[0].length,i=0,a=0;a<e.length;a++)for(var l=0;l<e[a].length;l++)e[a][l]&&(n=Math.min(n,a),r=Math.max(r,a),o=Math.min(o,l),i=Math.max(i,l));var u=(i-o+1)*t,h=(r-n+1)*t,s=(f.width-u)/2,d=(f.height-h)/2;c.fillStyle=y.color;for(var v=0;v<e.length;v++)for(var g=0;g<e[v].length;g++)if(e[v][g]){var m=s+(g-o)*t,p=d+(v-n)*t;c.fillRect(m,p,t,t),c.strokeStyle="#333333",c.lineWidth=1,c.strokeRect(m,p,t,t)}}}(),W()}}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",x):x()}},e=>{var t;t=795,e(e.s=t)}]);
//# sourceMappingURL=tetris.cb9d18727a79ffb76b94.js.map